
<h2 align= "center"><em>Microsoft Malware Detection</em></h2>

<div align="center">
  <img height="400" src="https://github.com/shreyjain99/Microsoft-Malware-Detection/blob/main/src%20files/Microsoft%20cover%20imaqge.jpg"/>
</div>

<hr width="100%" size="2">

<h3 align= "left"> <b> Key Project Formulation </b> </h3>

<br>

<p>
<strong>Real World/Business Objective :</strong> Identify wether a given piece of file/software is a malware or not. Given a file we should be able to determine which class of malware does it belong to.
</p>

<br>

<p>
<strong>Constraints :</strong>
</p>
<ol>
<li>Minimize multi-class error. </li>
<li>Multi-class probability estimates.</li>
<li>Latency(from few seconds to a minute)</li>
</ol>

<br>

<p>
<strong>Get the data from :</strong> https://www.kaggle.com/c/malware-classification/data
<br>The data is hosted by Microsoft as a Research Prediction Competition on kaggle
</p>

<br>

<p>
<strong>Data Overview :</strong>
<br>
<li> For every malware, we have two files <ol> <li> .asm file (read more: https://www.reviversoft.com/file-extensions/asm) </li><li>.bytes file (the raw data contains the hexadecimal representation of the file's binary content, without the PE header)</li></ol></li>
    
<li>Total train dataset consist of 200GB data out of which 50Gb of data is .bytes files and 150GB of data is .asm files:  </li>
<li><b>Lots of Data for a single-box/computer.</b> </li>

<li>There are total 10,868 .bytes files and 10,868 asm files total 21,736 files </li>

<li>There are 9 types of malwares (9 classes) in our give data</li>
<li> Types of Malware:
    <ol>
        <li> Ramnit </li>
        <li> Lollipop </li>
        <li> Kelihos_ver3 </li>
        <li> Vundo </li>
        <li> Simda </li>
        <li> Tracur </li>
        <li> Kelihos_ver1 </li>
        <li> Obfuscator.ACY </li>
        <li> Gatak </li>
    </ol>
</li>

<br>


<p>
<strong>Features in the dataset :</strong>
</p>
<pre>
<b>Id</b> - the id of a training set question pair<br />
<b>qid1, qid2</b> - unique ids of each question (only available in train.csv)<br />
<b>question1, question2</b> - the full text of each question<br />
<b>is_duplicate</b> - the target variable, set to 1 if question1 and question2 have essentially the same meaning, and 0 otherwise.<br />
</pre>

<br />

<br>

<p>
<strong>ML Problem Formulation :</strong>
</p>
<p> <strong>It is a binary classification problem, for a given pair of questions we need to predict if they are duplicate or not.</strong> </p>

<br>
<br>

<p>
<strong>Performance metrics :</strong>
</p>
<ol>
<li>log-loss </li>
<li>Binary Confusion Matrix</li>
</ol>

<hr width="100%" size="2">

<br>

<body>

  <h3>Flow of Project : </h3>
  
  <br>

  <h3 align= "center"><strong>Reading Data and Basic Stats</strong></h3>
  <p align= "center"><em> - Total number of unique questions </em></p>
  <p align= "center"><em> - Checking for Duplicates </em></p>
  <p align= "center"><em> - Number of occurrences of each question </em></p>
  <p align= "center"><em> - Checking for NULL values </em></p>
  
  <div align= "center">|</div>
  <div align= "center">|</div>
  <div align= "center">\/</div>

  <h3 align= "center"><strong>Basic Feature Extraction (before cleaning) </strong></h3>
  <p align= "center"><em> <strong> Constructing new features like :  </strong></em></p>
  <p align= "center"><em> 1. freq_qid1 = Frequency of qid1's </em></p>
  <p align= "center"><em> 2. freq_qid2 = Frequency of qid2's </em></p>
  <p align= "center"><em> 3. q1len = Length of q1 </em></p>
  <p align= "center"><em> 4. q2len = Length of q2 </em></p>
  <p align= "center"><em> 5. q1_n_words = Number of words in Question 1 </em></p>
  <p align= "center"><em> 6. q2_n_words = Number of words in Question 2 </em></p>
  <p align= "center"><em> 7. word_Common = Number of common unique words in Question 1 and Question 2 </em></p>
  <p align= "center"><em> 8. word_Total = Total num of words in Question 1 + Total num of words in Question 2 </em></p>
  <p align= "center"><em> 9. word_share = (word_common)/(word_Total) </em></p>
  <p align= "center"><em> 10. freq_q1+freq_q2 = sum total of frequency of qid1 and qid2 </em></p>
  <p align= "center"><em> 11. freq_q1-freq_q2 = absolute difference of frequency of qid1 and qid2 </em></p>

  <div align= "center">|</div>
  <div align= "center">|</div>
  <div align= "center">\/</div>

  <h3 align= "center">Preprocessing of text (Natural Language Processing)</h3>
  <p align= "center"><em> - Removing html tags </em></p>
  <p align= "center"><em> - Removing Punctuations </em></p>
  <p align= "center"><em> - Performing stemming </em></p>
  <p align= "center"><em> - Removing Stopwords </em></p>
  <p align= "center"><em> - Expanding contractions etc. </em></p>

  <div align= "center">|</div>
  <div align= "center">|</div>
  <div align= "center">\/</div>

  <h3 align= "center">Advanced Feature Extraction (NLP and Fuzzy Features)</h3>


  <div align= "center">|</div>
  <div align= "center">|</div>
  <div align= "center">\/</div>

  <h3 align= "center">Visualization of Data</h3>

  <div align= "center">|</div>
  <div align= "center">|</div>
  <div align= "center">\/</div>

  <h3 align= "center">Featurizing text data with tfidf weighted word-vectors </h3>

  <div align= "center">|</div>
  <div align= "center">|</div>
  <div align= "center">\/</div>

  <h3 align= "center">Building Machine Learning Models</h3>
  <p align= "center"><em> - Building a random model (Finding worst-case log-loss)  </em></p>
  <p align= "center"><em> - Logistic Regression with hyperparameter tuning   </em></p>
  <p align= "center"><em> - Linear SVM with hyperparameter tuning  </em></p>
  <p align= "center"><em> -  XGBoost </em></p>  



  
</body>

<hr width="100%" size="2">
<br>

<p>
<strong>Confusion matrices of the best model :</strong>
</p>
<div align="center">
  <img height="200" src="https://github.com/shreyjain99/Quora-Question-Pair-Similarity/blob/main/src%20files/image.png"/>
</div>

<br>

<p>
<strong>Future Scope :</strong>
</p>
<ol>
<li>Try out models (Logistic regression, Linear-SVM) with simple TF-IDF vectors instead of TD_IDF weighted word2Vec. </li>
<li>Perform hyperparameter tuning of XgBoost models using RandomsearchCV with vectorizer as TF-IDF W2V to reduce the log-loss.</li>
</ol>

<hr width="100%" size="2">
